{
    "fragments": [
        {
            "operators": [
                {
                    "opName": "Scan_base",
                    "opType": "QueryScan",
                    "schema": {
                        "columnNames": [
                            "iOrder",
                            "grp"
                        ],
                        "columnTypes": [
                            "LONG_TYPE",
                            "INT_TYPE"
                        ]
                    },
                    "sql": "SELECT iOrder, grp FROM [leelee#astro#cosmo512] WHERE type='star'"
                },
                {
                    "argChild": "Scan_base",
                    "argPf": {
                        "index": "0",
                        "type": "SingleFieldHash"
                    },
                    "opName": "SP_base",
                    "opType": "ShuffleProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "opName": "Scan_pgtr",
                    "opType": "QueryScan",
                    "schema": {
                        "columnNames": [
                            "iOrder",
                            "grp"
                        ],
                        "columnTypes": [
                            "LONG_TYPE",
                            "INT_TYPE"
                        ]
                    },
                    "sql": "SELECT iOrder, grp FROM [leelee#astro#cosmo512] WHERE grp<>0"
                },
                {
                    "argChild": "Scan_pgtr",
                    "argPf": {
                        "index": "0",
                        "type": "SingleFieldHash"
                    },
                    "opName": "SP_pgtr",
                    "opType": "ShuffleProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "argOperatorId": "SP_base",
                    "opName": "SC1",
                    "opType": "ShuffleConsumer"
                },
                {
                    "argOperatorId": "SP_pgtr",
                    "opName": "SC2",
                    "opType": "ShuffleConsumer"
                },
                {
                    "argChild1": "SC1",
                    "argChild2": "SC2",
                    "argColumns1": [
                        "0"
                    ],
                    "argColumns2": [
                        "0"
                    ],
                    "argSelect1": [
                        "0",
                        "1"
                    ],
                    "argSelect2": [
                        "1"
                    ],
                    "opName": "JoinOnIOrder",
                    "opType": "SymmetricHashJoin"
                },
                {
                    "argChild": "JoinOnIOrder",
                    "argPf": {
                        "index": "1",
                        "type": "SingleFieldHash"
                    },
                    "opName": "SP_JoinOnIOrder",
                    "opType": "ShuffleProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "opName": "Scan_grps_of_interest",
                    "opType": "TableScan",
                    "relationKey": {
                        "programName": "astro",
                        "relationName": "grps_of_interest",
                        "userName": "leelee"
                    }
                },
                {
                    "argChild": "Scan_grps_of_interest",
                    "argPf": {
                        "index": "0",
                        "type": "SingleFieldHash"
                    },
                    "opName": "SP_grps_of_interest",
                    "opType": "ShuffleProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "argOperatorId": "SP_JoinOnIOrder",
                    "opName": "SC3",
                    "opType": "ShuffleConsumer"
                },
                {
                    "argOperatorId": "SP_grps_of_interest",
                    "opName": "SC4",
                    "opType": "ShuffleConsumer"
                },
                {
                    "argChild1": "SC3",
                    "argChild2": "SC4",
                    "argColumns1": [
                        "1"
                    ],
                    "argColumns2": [
                        "0"
                    ],
                    "argSelect1": [
                        "0",
                        "1",
                        "2"
                    ],
                    "argSelect2": [
                        "0"
                    ],
                    "opName": "JoinOnIOrderWihGroupsOfInterest",
                    "opType": "SymmetricHashJoin"
                },
                {
                    "argChild": "JoinOnIOrderWihGroupsOfInterest",
                    "argPf": {
                        "index": [
                            "1",
                            "2"
                        ],
                        "type": "MultiFieldHash"
                    },
                    "opName": "SP_JoinOnIOrderWithGroupsOfInterest",
                    "opType": "ShuffleProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "argOperatorId": "SP_JoinOnIOrderWithGroupsOfInterest",
                    "opName": "SC_JoinOnIOrderWithGroupsOfInterest",
                    "opType": "ShuffleConsumer"
                },
                {
                    "argAggFields": [
                        "0"
                    ],
                    "argAggOperators": [
                        [
                            "AGG_OP_COUNT"
                        ]
                    ],
                    "argChild": "SC_JoinOnIOrderWithGroupsOfInterest",
                    "argGroupFields": [
                        "1",
                        "2"
                    ],
                    "opName": "PotentialProgenitorGroup",
                    "opType": "MultiGroupByAggregate"
                },
                {
                    "argChild": "PotentialProgenitorGroup",
                    "opName": "PotPro",
                    "opType": "LocalMultiwayProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "opName": "Scan_masstable",
                    "opType": "TableScan",
                    "relationKey": {
                        "programName": "astro",
                        "relationName": "masstable",
                        "userName": "leelee"
                    }
                },
                {
                    "argChild": "Scan_masstable",
                    "argPf": {
                        "index": "0",
                        "type": "SingleFieldHash"
                    },
                    "opName": "SP_masstable",
                    "opType": "ShuffleProducer"
                }
            ]
        },
        {
            "operators": [
                {
                    "argOperatorId": "SP_masstable",
                    "opName": "SC_masstable",
                    "opType": "ShuffleConsumer"
                },
                {
                    "argOperatorId": "PotPro",
                    "opName": "PotPro1",
                    "opType": "LocalMultiwayConsumer"
                },
                {
                    "argAggFields": [
                        "2"
                    ],
                    "argAggOperators": [
                        [
                            "AGG_OP_MAX"
                        ]
                    ],
                    "argChild": "PotPro1",
                    "argGroupField": 0,
                    "opName": "GrpsWithMaxVals",
                    "opType": "SingleGroupByAggregate"
                },
                {
                    "argOperatorId": "PotPro",
                    "opName": "PotPro2",
                    "opType": "LocalMultiwayConsumer"
                },
                {
                    "argChild1": "PotPro2",
                    "argChild2": "GrpsWithMaxVals",
                    "argColumns1": [
                        "0",
                        "2"
                    ],
                    "argColumns2": [
                        "0",
                        "1"
                    ],
                    "argSelect1": [
                        "0",
                        "1",
                        "2"
                    ],
                    "argSelect2": [
                        "0"
                    ],
                    "opName": "SelectedProgenitorJoined",
                    "opType": "SymmetricHashJoin"
                },
                {
                    "argAggFields": [
                        "1"
                    ],
                    "argAggOperators": [
                        [
                            "AGG_OP_MIN"
                        ]
                    ],
                    "argChild": "SelectedProgenitorJoined",
                    "argGroupField": 0,
                    "opName": "SelectedProgenitorGroupedBy",
                    "opType": "SingleGroupByAggregate"
                },
                {
                    "argChild1": "SelectedProgenitorGroupedBy",
                    "argChild2": "SC_masstable",
                    "argColumns1": [
                        "1"
                    ],
                    "argColumns2": [
                        "0"
                    ],
                    "argSelect1": [
                        "0",
                        "1"
                    ],
                    "argSelect2": [
                        "1"
                    ],
                    "opName": "result",
                    "opType": "SymmetricHashJoin"
                },
                {
                    "argChild": "result",
                    "argOverwriteTable": true,
                    "opName": "INSERT",
                    "opType": "DbInsert",
                    "relationKey": {
                        "programName": "astro",
                        "relationName": "progenitor512-512",
                        "userName": "leelee"
                    }
                }
            ]
        }
    ],
    "logicalRa": "progenitor512-512 holds the results of a large progenitor query",
    "rawDatalog": "blah."
}
